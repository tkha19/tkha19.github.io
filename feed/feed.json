{
  "version": "https://jsonfeed.org/version/1",
  "title": "Kha&#39;s - Journeys and times of me",
  "home_page_url": "https://lotusirous.github.io/",
  "feed_url": "https://lotusirous.github.io/feed/feed.json",
  "description": "This place is a note for myself",
  "author": {
    "name": "Your Name Here",
    "url": "https://lotusirous.github.io/about-me/"
  },
  "items": [{
      "id": "https://lotusirous.github.io/posts/function-snippet-for-go/",
      "url": "https://lotusirous.github.io/posts/function-snippet-for-go/",
      "title": "Generate return values in Neovim for Go.",
      "content_html": "<p>I really love error handling in go because of explicitly. However, typing <code>if err != nil</code> every time you want to handle the error is quite annoying.\nThis post describes the step to combine the <a href=\"https://github.com/nvim-treesitter/nvim-treesitter\">nvim-treesitter</a> and <a href=\"https://github.com/L3MON4D3/LuaSnip\">LuaSnip</a> to generate the return values. It makes you type less keystrokes than before.</p>\n<h2>Tree sitter</h2>\n<p>Tree-sitter parses the go file and generate the AST</p>\n<pre class=\"language-lua\"><code class=\"language-lua\">vim<span class=\"token punctuation\">.</span>treesitter<span class=\"token punctuation\">.</span><span class=\"token function\">set_query</span><span class=\"token punctuation\">(</span><br>    <span class=\"token string\">\"go\"</span><span class=\"token punctuation\">,</span><br>    <span class=\"token string\">\"LuaSnip_Result\"</span><span class=\"token punctuation\">,</span><br>    <span class=\"token string\">[[ [<br>    (method_declaration result: (_) @id)<br>    (function_declaration result: (_) @id)<br>    (func_literal result: (_) @id)<br>  ] ]]</span><br><span class=\"token punctuation\">)</span></code></pre>\n<p>You query the method, function, name and saves to the variable <code>LuaSnip_Result</code></p>\n<h2>Assign the snippet</h2>\n<p>I honestly admit that the syntax for LuaSnip is quite ugly.</p>\n<pre class=\"language-lua\"><code class=\"language-lua\">    <span class=\"token function\">s</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"iferr\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><br>        <span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"val\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>        t <span class=\"token string\">\", \"</span><span class=\"token punctuation\">,</span><br>        <span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"err\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>        t <span class=\"token string\">\" := \"</span><span class=\"token punctuation\">,</span><br>        <span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"f\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>        <span class=\"token function\">t</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"if \"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br>        <span class=\"token function\">same</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>        <span class=\"token function\">t</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\" != nil {\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\treturn \"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br>        <span class=\"token function\">d</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> go_ret_vals<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>        <span class=\"token function\">t</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"}\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><br>        <span class=\"token function\">i</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><br>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></code></pre>\n<p>Give it a try</p>\n<pre><code>iferr&lt;c-k&gt;\n</code></pre>\n<p>And BOOOMMMM !!</p>\n<h2>Discussion</h2>\n<p>This method reduces your typing keystrokes. However, the current method does not support the function that does not return any value. Neovim will raise an error for that.</p>\n",
      "date_published": "2022-05-28T00:00:00Z"
    },{
      "id": "https://lotusirous.github.io/posts/smart-contract-practices/",
      "url": "https://lotusirous.github.io/posts/smart-contract-practices/",
      "title": "Smart contract hacking resources",
      "content_html": "<p>I'm using the following resources to build up the background to learn/hack/secure the smart contract</p>\n<h2>Background</h2>\n<p>Books:</p>\n<ul>\n<li>Mastering Ethereum: Building Smart Contracts and DApps</li>\n<li>Building Ethereum DApps: Decentralized Applications on the Ethereum Blockchain</li>\n</ul>\n<p>Tutorials:</p>\n<ul>\n<li><a href=\"https://ethereum.org/en/developers/learning-tools/\">All tutorials and learning-by-coding from ETH</a></li>\n<li>Learn Solidity</li>\n<li><a href=\"https://cryptozombies.io/\">CryptoZombies</a></li>\n<li><a href=\"https://solidity-by-example.org/\">Solidity by Example</a></li>\n<li>Solidity Docs</li>\n<li>Learn how to use <a href=\"https://hardhat.org/\">HardHat</a></li>\n<li>Familiarize yourself with widely used contracts (EIP 20)</li>\n</ul>\n<h2>Challenges</h2>\n<ul>\n<li>Read writeups &amp; postmortems</li>\n<li>Do some CTF's</li>\n</ul>\n<h2>Resources</h2>\n<ul>\n<li><a href=\"https://youtu.be/M576WGiDBdQ\">Solidity, Blockchain, and Smart Contract Course – Beginner to Expert Python Tutorial</a></li>\n<li><a href=\"https://blog.sigmaprime.io/-solidity-security.html\">Solidity Security: Comprehensive list of known attack vectors and common anti-patterns</a></li>\n<li><a href=\"https://swcregistry.io/\">Smart Contract Weakness Classification and Test Cases</a></li>\n<li><a href=\"https://consensys.github.io/smart-contract-best-practices/\">Ethereum Smart Contract Security Best Practices</a></li>\n</ul>\n",
      "date_published": "2021-10-17T00:00:00Z"
    },{
      "id": "https://lotusirous.github.io/posts/flare-on-challenge-1/",
      "url": "https://lotusirous.github.io/posts/flare-on-challenge-1/",
      "title": "[Flare on 2020] Level 1",
      "content_html": "<p>This article belongs to the flare on write up series</p>\n<h2>Level 1</h2>\n<p>This challenge is a python that have compiled to windows program. The organizer also gives us a source code of this program. Let's dive into the code by static analysis. We have the following functions</p>\n<pre class=\"language-txt\"><code class=\"language-txt\"> +buy_click : function<br> +cat_clicked : function<br> +decode_flag : function &lt;--<br> +game_screen : function<br> +main : function<br> +password_check : function &lt;--<br> +password_fail_screen : function<br> +password_screen : function<br> +victory_screen : function<br>▼ variables<br>    buying<br>    current_autoclickers<br>    current_coins<br></code></pre>\n<p>2 functions <code>password_check</code> and <code>decode_flag</code> are suspicious. Let's parse the function step by step.</p>\n<p><strong>The <code>password_check</code> function</strong></p>\n<p>Since the program requires user to enter a password with a protect screen, the developer implements this feature by 2 functions:</p>\n<ul>\n<li><code>password_screen</code> shows the input text.</li>\n<li><code>password_check</code> checks the password as follows</li>\n</ul>\n<pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">def</span> <span class=\"token function\">password_check</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><br>    altered_key <span class=\"token operator\">=</span> <span class=\"token string\">\"hiptu\"</span><br>    key <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> altered_key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><br>    <span class=\"token keyword\">return</span> <span class=\"token builtin\">input</span> <span class=\"token operator\">==</span> key</code></pre>\n<p>The solution is super simple,\nthey key is &quot;ghost&quot; by runnning the code in python interpreter <code>print(&quot;&quot;.join([chr(ord(x) - 1) for x in &quot;hiptu&quot;]))</code></p>\n<p><strong>The <code>decode_flag</code> function</strong></p>\n<p>I found the function <code>victory_screen(token)</code> calls the <code>decode_flag</code> by the find references feature from <a href=\"https://microsoft.github.io/language-server-protocol/\">LSP</a>,\nThe <code>game_screen</code> computes the <code>token</code> by the following logic:</p>\n<pre class=\"language-py\"><code class=\"language-py\">target_amount <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">36</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span><br><span class=\"token keyword\">if</span> current_coins <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span>target_amount <span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><br>    <span class=\"token keyword\">while</span> current_coins <span class=\"token operator\">>=</span> <span class=\"token punctuation\">(</span>target_amount <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><br>        current_coins <span class=\"token operator\">-=</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><br>    victory_screen<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>current_coins <span class=\"token operator\">/</span> <span class=\"token number\">10</span> <span class=\"token operator\">**</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>    <span class=\"token keyword\">return</span></code></pre>\n<p>Since we need the program to show the victory screen, the <code>current_coins</code> should have the value greater than <code>(target_amount - 2 ** 20)</code></p>\n<pre class=\"language-python\"><code class=\"language-python\">target_amount <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">36</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>  <span class=\"token comment\"># +1 to jump inside the while loop.</span><br>current_coins <span class=\"token operator\">=</span> target_amount <span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><br><span class=\"token keyword\">while</span> current_coins <span class=\"token operator\">>=</span> <span class=\"token punctuation\">(</span>target_amount <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><br>    current_coins <span class=\"token operator\">-=</span> <span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">20</span><br>token <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>current_coins <span class=\"token operator\">/</span> <span class=\"token number\">10</span> <span class=\"token operator\">**</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span></code></pre>\n<p>Now I can call the <code>decode_flag</code> with the computed token and get the flag.</p>\n<pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>decode_flag<span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><br>idle_with_kitty@flare<span class=\"token operator\">-</span>on<span class=\"token punctuation\">.</span>com</code></pre>\n",
      "date_published": "2020-10-17T00:00:00Z"
    }
  ]
}
